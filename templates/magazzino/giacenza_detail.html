{% extends 'base.html' %}
{% load static %}

{% block title %}{{ giacenza.articolo.codice_interno }} - Giacenza - Gestione Magazzino{% endblock %}

{% block content %}

<h1 class="page-title">
    <i class="fas fa-chart-pie"></i> Giacenza: {{ giacenza.articolo.codice_interno }}
</h1>

<!-- BOTTONI AZIONI -->
<div class="mb-3">
    <a href="{% url 'magazzino:articolo_detail' giacenza.articolo.id_articolo %}" class="btn btn-info">
        <i class="fas fa-cube"></i> Visualizza Articolo
    </a>
    <a href="{% url 'magazzino:giacenza_list' %}" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Indietro
    </a>
</div>

<div class="row">
    <!-- INFORMAZIONI ARTICOLO -->
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-cube"></i> Informazioni Articolo
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-5">Codice Interno:</dt>
                    <dd class="col-sm-7"><strong>{{ giacenza.articolo.codice_interno }}</strong></dd>

                    <dt class="col-sm-5">Descrizione:</dt>
                    <dd class="col-sm-7">{{ giacenza.articolo.descrizione }}</dd>

                    <dt class="col-sm-5">Categoria:</dt>
                    <dd class="col-sm-7">{{ giacenza.articolo.categoria.nome_categoria }}</dd>

                    <dt class="col-sm-5">Unità Misura:</dt>
                    <dd class="col-sm-7">{{ giacenza.articolo.unita_misura.denominazione }}</dd>

                    <dt class="col-sm-5">Giacenza Min:</dt>
                    <dd class="col-sm-7">{{ giacenza.articolo.giacenza_minima }}</dd>

                    <dt class="col-sm-5">Giacenza Max:</dt>
                    <dd class="col-sm-7">{{ giacenza.articolo.giacenza_massima }}</dd>
                </dl>
            </div>
        </div>
    </div>

    <!-- INFORMAZIONI GIACENZA -->
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-boxes"></i> Quantità e Stock
            </div>
            <div class="card-body">
                <div class="mb-4">
                    <label class="form-label text-muted">Quantità Disponibile</label>
                    <div style="font-size: 2.5rem; color: #2a8db8; font-weight: bold;">
                        {{ giacenza.quantita_disponibile }} {{ giacenza.articolo.unita_misura.denominazione }}
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label text-muted">Quantità Impegnata</label>
                    <div style="font-size: 1.5rem; color: #f39c12; font-weight: bold;">
                        {{ giacenza.quantita_impegnata }} {{ giacenza.articolo.unita_misura.denominazione }}
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label text-muted">Quantità Prenotata</label>
                    <div style="font-size: 1.5rem; color: #3498db; font-weight: bold;">
                        {{ giacenza.quantita_prenotata }} {{ giacenza.articolo.unita_misura.denominazione }}
                    </div>
                </div>

                <hr>

                <div>
                    <label class="form-label text-muted">Quantità Libera (disponibile - impegnata - prenotata)</label>
                    <div style="font-size: 2rem; color: #27ae60; font-weight: bold;">
                        {{ giacenza.quantita_libera }} {{ giacenza.articolo.unita_misura.denominazione }}
                    </div>
                </div>
            </div>
        </div>

        <!-- STATO GIACENZA -->
        <div class="card mt-3">
            <div class="card-header">
                <i class="fas fa-traffic-light"></i> Stato Giacenza
            </div>
            <div class="card-body">
                {% if giacenza.quantita_disponibile < giacenza.articolo.giacenza_minima %}
                <div class="alert alert-danger mb-0">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>SOTTO SOGLIA MINIMA!</strong><br>
                    <small>Disponibile: {{ giacenza.quantita_disponibile }} < Minima: {{ giacenza.articolo.giacenza_minima }}</small>
                </div>
                {% elif giacenza.quantita_disponibile > giacenza.articolo.giacenza_massima %}
                <div class="alert alert-warning mb-0">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>SOPRA SOGLIA MASSIMA!</strong><br>
                    <small>Disponibile: {{ giacenza.quantita_disponibile }} > Massima: {{ giacenza.articolo.giacenza_massima }}</small>
                </div>
                {% else %}
                <div class="alert alert-success mb-0">
                    <i class="fas fa-check-circle"></i>
                    <strong>STOCK OK</strong><br>
                    <small>Giacenza entro i limiti previsti</small>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- INFORMAZIONI AGGIORNAMENTO -->
<div class="card mt-3">
    <div class="card-header">
        <i class="fas fa-clock"></i> Informazioni Aggiornamento
    </div>
    <div class="card-body">
        <p class="mb-0">
            <strong>Ultimo aggiornamento:</strong> {{ giacenza.ultimo_aggiornamento|date:"d/m/Y H:i:s" }}
        </p>
    </div>
</div>

{% endblock %}
